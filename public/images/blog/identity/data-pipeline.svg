<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 420" font-family="'Segoe UI', -apple-system, system-ui, sans-serif">
  <defs>
    <linearGradient id="bgG5" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f9fafb"/>
      <stop offset="100%" style="stop-color:#f0f4f8"/>
    </linearGradient>
    <filter id="sh5" x="-4%" y="-4%" width="112%" height="112%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#1F4E79" flood-opacity="0.12"/>
    </filter>
    <marker id="a5" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#1F4E79"/>
    </marker>
    <marker id="a5t" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#2A7F62"/>
    </marker>
    <marker id="a5g" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#8899aa"/>
    </marker>
  </defs>

  <rect width="960" height="420" fill="url(#bgG5)" rx="8"/>

  <!-- Phase labels -->
  <rect x="28" y="42" width="195" height="24" rx="4" fill="#1F4E79" fill-opacity="0.08"/>
  <text x="125" y="58" text-anchor="middle" fill="#1F4E79" font-size="9" font-weight="700" letter-spacing="0.5">DATA EXTRACTION &amp; TRANSFORM</text>

  <rect x="240" y="42" width="290" height="24" rx="4" fill="#1F4E79" fill-opacity="0.08"/>
  <text x="385" y="58" text-anchor="middle" fill="#1F4E79" font-size="9" font-weight="700" letter-spacing="0.5">ORCHESTRATION &amp; INCREMENTAL MODEL UPDATES</text>

  <rect x="548" y="42" width="160" height="24" rx="4" fill="#1F4E79" fill-opacity="0.08"/>
  <text x="628" y="58" text-anchor="middle" fill="#1F4E79" font-size="9" font-weight="700" letter-spacing="0.5">GRAPH DB &amp; GDS</text>

  <rect x="726" y="42" width="215" height="24" rx="4" fill="#2A7F62" fill-opacity="0.08"/>
  <text x="833" y="58" text-anchor="middle" fill="#2A7F62" font-size="9" font-weight="700" letter-spacing="0.5">INFERENCE, QUERIES &amp; ANALYSIS</text>

  <!-- ===== MAIN PIPELINE ===== -->

  <!-- Snowflake -->
  <rect x="30" y="130" width="120" height="80" rx="10" fill="#fff" stroke="#1F4E79" stroke-width="2" filter="url(#sh5)"/>
  <text x="90" y="162" text-anchor="middle" fill="#1F4E79" font-size="20">‚ùÑÔ∏è</text>
  <text x="90" y="185" text-anchor="middle" fill="#1F4E79" font-size="11" font-weight="700">Snowflake</text>
  <text x="90" y="200" text-anchor="middle" fill="#8899aa" font-size="8">Source Data Warehouse</text>

  <!-- Arrow -->
  <line x1="152" y1="170" x2="180" y2="170" stroke="#1F4E79" stroke-width="2" marker-end="url(#a5)"/>

  <!-- Python Extract -->
  <rect x="190" y="130" width="100" height="80" rx="10" fill="#fff" stroke="#1F4E79" stroke-width="2" filter="url(#sh5)"/>
  <text x="240" y="162" text-anchor="middle" fill="#1F4E79" font-size="20">üêç</text>
  <text x="240" y="185" text-anchor="middle" fill="#1F4E79" font-size="11" font-weight="700">Python</text>
  <text x="240" y="200" text-anchor="middle" fill="#8899aa" font-size="8">Clean &amp; Transform</text>

  <!-- Arrow -->
  <line x1="292" y1="170" x2="320" y2="170" stroke="#1F4E79" stroke-width="2" marker-end="url(#a5)"/>

  <!-- PySpark -->
  <rect x="330" y="130" width="110" height="80" rx="10" fill="#fff" stroke="#1F4E79" stroke-width="2" filter="url(#sh5)"/>
  <text x="385" y="162" text-anchor="middle" fill="#1F4E79" font-size="20">‚ö°</text>
  <text x="385" y="185" text-anchor="middle" fill="#1F4E79" font-size="11" font-weight="700">PySpark</text>
  <text x="385" y="200" text-anchor="middle" fill="#8899aa" font-size="8">Parallel ingestion</text>

  <!-- Arrow -->
  <line x1="442" y1="170" x2="470" y2="170" stroke="#1F4E79" stroke-width="2" marker-end="url(#a5)"/>

  <!-- EMR -->
  <rect x="480" y="130" width="120" height="80" rx="10" fill="#fff" stroke="#1F4E79" stroke-width="2" filter="url(#sh5)"/>
  <text x="540" y="158" text-anchor="middle" fill="#e67e22" font-size="11" font-weight="700">Amazon</text>
  <text x="540" y="175" text-anchor="middle" fill="#e67e22" font-size="14" font-weight="700">EMR</text>
  <text x="540" y="200" text-anchor="middle" fill="#8899aa" font-size="8">Transient cluster</text>

  <!-- Arrow -->
  <line x1="602" y1="170" x2="630" y2="170" stroke="#1F4E79" stroke-width="2" marker-end="url(#a5)"/>

  <!-- Neo4j -->
  <rect x="640" y="115" width="130" height="110" rx="10" fill="#fff" stroke="#1F4E79" stroke-width="2.5" filter="url(#sh5)"/>
  <rect x="640" y="115" width="130" height="35" rx="10" fill="#1F4E79"/>
  <rect x="640" y="138" width="130" height="12" fill="#1F4E79"/>
  <text x="705" y="140" text-anchor="middle" fill="#fff" font-size="12" font-weight="700">Neo4j</text>
  <!-- Mini graph icon -->
  <circle cx="685" cy="175" r="5" fill="#1F4E79" fill-opacity="0.5"/>
  <circle cx="710" cy="165" r="5" fill="#2A7F62" fill-opacity="0.5"/>
  <circle cx="725" cy="185" r="5" fill="#e67e22" fill-opacity="0.5"/>
  <line x1="690" y1="175" x2="705" y2="167" stroke="#1F4E79" stroke-width="1"/>
  <line x1="715" y1="167" x2="720" y2="182" stroke="#2A7F62" stroke-width="1"/>
  <line x1="690" y1="178" x2="720" y2="183" stroke="#8899aa" stroke-width="0.8" stroke-dasharray="2,1"/>
  <text x="705" y="207" text-anchor="middle" fill="#1F4E79" font-size="9" font-weight="600">+ GDS Plugin</text>
  <text x="705" y="220" text-anchor="middle" fill="#8899aa" font-size="7.5">EC2: 256GB RAM, 8 cores</text>

  <!-- Arrow to consumption -->
  <line x1="772" y1="155" x2="805" y2="130" stroke="#2A7F62" stroke-width="2" marker-end="url(#a5t)"/>
  <line x1="772" y1="185" x2="805" y2="210" stroke="#2A7F62" stroke-width="2" marker-end="url(#a5t)"/>

  <!-- Consumption: Tableau / NeoDash -->
  <rect x="812" y="90" width="130" height="70" rx="10" fill="#fff" stroke="#2A7F62" stroke-width="2" filter="url(#sh5)"/>
  <text x="877" y="118" text-anchor="middle" fill="#2A7F62" font-size="11" font-weight="700">Tableau</text>
  <text x="877" y="134" text-anchor="middle" fill="#2A7F62" font-size="10">+ NeoDash</text>
  <text x="877" y="150" text-anchor="middle" fill="#8899aa" font-size="8">Interactive analysis</text>

  <!-- Consumption: Python Analytics -->
  <rect x="812" y="178" width="130" height="70" rx="10" fill="#fff" stroke="#2A7F62" stroke-width="2" filter="url(#sh5)"/>
  <text x="877" y="206" text-anchor="middle" fill="#2A7F62" font-size="11" font-weight="700">Python</text>
  <text x="877" y="222" text-anchor="middle" fill="#2A7F62" font-size="10">Analytics</text>
  <text x="877" y="238" text-anchor="middle" fill="#8899aa" font-size="8">Cypher queries + ML</text>

  <!-- ===== ORCHESTRATION (AWS Step Functions) ===== -->
  <rect x="350" y="82" width="230" height="30" rx="6" fill="#e67e22" fill-opacity="0.08" stroke="#e67e22" stroke-width="1" stroke-dasharray="3,2"/>
  <text x="465" y="101" text-anchor="middle" fill="#e67e22" font-size="8.5" font-weight="600">AWS Step Functions ‚Äî Launch ‚Üí Run ‚Üí Teardown</text>

  <!-- ===== FEEDBACK LOOP: Graph Features ‚Üí Snowflake ===== -->
  <rect x="30" y="290" width="910" height="110" rx="10" fill="#1F4E79" fill-opacity="0.03" stroke="#1F4E79" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="480" y="314" text-anchor="middle" fill="#1F4E79" font-size="11" font-weight="700">GRAPH-INFERRED FEATURE STORAGE &amp; FEEDBACK LOOP</text>

  <!-- Feature export path -->
  <rect x="640" y="330" width="130" height="55" rx="8" fill="#fff" stroke="#1F4E79" stroke-width="1.5" filter="url(#sh5)"/>
  <text x="705" y="352" text-anchor="middle" fill="#1F4E79" font-size="9.5" font-weight="600">Feature Export</text>
  <text x="705" y="366" text-anchor="middle" fill="#8899aa" font-size="8">Centrality, community</text>
  <text x="705" y="378" text-anchor="middle" fill="#8899aa" font-size="8">membership, embeddings</text>

  <!-- Arrow from Neo4j down -->
  <line x1="705" y1="227" x2="705" y2="328" stroke="#1F4E79" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#a5)"/>

  <!-- PySpark export -->
  <rect x="460" y="330" width="110" height="55" rx="8" fill="#fff" stroke="#1F4E79" stroke-width="1.5" filter="url(#sh5)"/>
  <text x="515" y="352" text-anchor="middle" fill="#1F4E79" font-size="9.5" font-weight="600">PySpark</text>
  <text x="515" y="368" text-anchor="middle" fill="#8899aa" font-size="8">Export to warehouse</text>

  <line x1="638" y1="357" x2="572" y2="357" stroke="#1F4E79" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#a5)"/>

  <!-- Back to Snowflake -->
  <rect x="220" y="330" width="170" height="55" rx="8" fill="#fff" stroke="#1F4E79" stroke-width="1.5" filter="url(#sh5)"/>
  <text x="305" y="348" text-anchor="middle" fill="#1F4E79" font-size="20">‚ùÑÔ∏è</text>
  <text x="305" y="370" text-anchor="middle" fill="#1F4E79" font-size="9.5" font-weight="600">Feature Store / DWH</text>
  <text x="305" y="382" text-anchor="middle" fill="#8899aa" font-size="8">ML model training inputs</text>

  <line x1="458" y1="357" x2="392" y2="357" stroke="#1F4E79" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#a5)"/>

  <!-- Reporting arrow back up to Tableau -->
  <line x1="90" y1="212" x2="90" y2="345" stroke="#8899aa" stroke-width="1" stroke-dasharray="3,2"/>
  <line x1="90" y1="345" x2="218" y2="345" stroke="#8899aa" stroke-width="1" stroke-dasharray="3,2"/>
  <!-- And from Feature store to Tableau -->
  <path d="M305,330 L305,270 Q305,260 315,260 L877,260 Q887,260 887,250 L887,250" fill="none" stroke="#8899aa" stroke-width="1" stroke-dasharray="3,2" marker-end="url(#a5g)"/>
</svg>
